// Common data
var tags = [
   [ 'sales','innovator'], ['javascript','css','oodb','sql','linux'],[ 'accounting','bookkeeping','cpa','auditing']

];

var contacts = [
  {
    firstName: "Doe",
    lastName: "Samantha"
  },
  {
    firstName: "Reagan",
    lastName: "John"
  },
  {
    firstName: "Ryan",
    lastName: "Darcy"
  },
  {
    firstName: "Campos",
    lastName: "Jeff"
  },
  {
    firstName: "Belton",
    lastName: "Joseph"
  },
  {
    firstName: "Sotono",
    lastName: "Reggie"
  },
  {
    firstName: "Columbo",
    lastName: "Jeff"
  },
  {
    firstName: "Bond",
    lastName: "James"
  },
  {
    firstName: "Cameron",
    lastName: "Sandy"
  },
  {
    firstName: "Velotos",
    lastName: "Remie"
  }
];
var employees = [
  {
    firstName: "Eagleton",
    lastName: "Andrew"
  },
  {
    firstName: "Gate",
    lastName: "John"
  },
  {
    firstName: "Smith",
    lastName: "John"
  },
  {
    firstName: "Ruffington",
    lastName: "Wilson"
  },
  {
    firstName: "Berneche",
    lastName: "Joe"
  },
  {
    firstName: "Soto",
    lastName: "Roger"
  },
  {
    firstName: "Schrute",
    lastName: "Anna"
  },
  {
    firstName: "Pankerton",
    lastName: "Johnny"
  },
  {
    firstName: "Pasarini",
    lastName: "Fernando"
  },
  {
    firstName: "Campos",
    lastName: "Jeffrey"
  },
  {
    firstName: "Climer",
    lastName: "Rae"
  },
  {
    firstName: "Lewis",
    lastName: "James"
  },
  {
    firstName: "Love",
    lastName: "Jeff"
  },
  {
    firstName: "Jones",
    lastName: "Debbie"
  },
  {
    firstName: "Barbeau",
    lastName: "Adrian"
  },
  {
    firstName: "Pasarini",
    lastName: "Vito"
  },
  {
    firstName: "Lee",
    lastName: "Nestor"
  },
  {
    firstName: "McKee",
    lastName: "Geoffrey"
  },
  {
    firstName: "Pennington",
    lastName: "Charlene"
  },
  {
    firstName: "Wayne",
    lastName: "John"
  },
  {
    firstName: "Norris",
    lastName: "Aram"
  },
  {
    firstName: "Bean",
    lastName: "Mark"
  },
  {
    firstName: "Cossey",
    lastName: "Michael"
  },
  {
    firstName: "Edwards",
    lastName: "Robert"
  },
  {
    firstName: "Fox",
    lastName: "William"
  },
  {
    firstName: "Crosby",
    lastName: "Howard"
  },
  {
    firstName: "Small",
    lastName: "Jeff"
  },
  {
    firstName: "Whitson",
    lastName: "Charles"
  },
  {
    firstName: "Hart",
    lastName: "Pamela"
  },
  {
    firstName: "Cossey",
    lastName: "Zoe"
  }
];

// 57 Customers
var customers = [
  {
    "name": "Yahoo",
    "department": "Shipping"
  },
  {
    "name": "ABC Corporation",
    "department": "Shipping"
  },
  {
    "name": "Action Staffing Solutions",
    "department": "Primary"
  },
  {
    "name": "Seintco",
    "department": "Labor Dispatch 1"
  },
  {
    "name": "Aldi Inc",
    "department": "Tap Room"
  },
  {
    "name": "Ames Construction, Inc.",
    "department": "Primary"
  },
  {
    "name": "Aquafina",
    "department": "Primary"
  },
  {
    "name": "Atlanta Staffing Source Inc",
    "department": "Sourcing"
  },
  {
    "name": "ATS Staffing",
    "department": "Primary"
  },
  {
    "name": "Best Buy",
    "department": "Store #456"
  },
  {
    "name": "Birkshire Lighting",
    "department": "Warehouse"
  },
  {
    "name": "CompUSA",
    "department": "Primary"
  },
  {
    "name": "Crom Equipment",
    "department": "Warehouse"
  },

  {
    "name": "Crom Equipment",
    "department": "Shipping"
  },
  {
    "name": "Dees Diner",
    "department": "Payroll"
  },
  {
    "name": "Dover Staffing",
    "department": "Primary"
  },
  {
    "name": "Elephant Industries Inc.",
    "department": "Human Resources"
  },
  {
    "name": "Flavor Splash",
    "department": "MIsc"
  },
  {
    "name": "Green Thumb",
    "department": "Warehouse"
  },
  {
    "name": "Green Thumb",
    "department": "Primary"
  },
  {
    "name": "Harper Designs",
    "department": "Warehouse"
  },
  {
    "name": "Mel's Tree Service",
    "department": "Primary"
  },
  {
    "name": "Midwest Wireless",
    "department": "Accountign"
  },
  {
    "name": "Midwest Wireless",
    "department": "Primary"
  },
  {
    "name": "Ohio Health",
    "department": "Warehouse"
  },
  {
    "name": "Pencil Designs Inc",
    "department": "Metal Bands"
  },
  {
    "name": "Prestige Staffing",
    "department": "Primary"
  },
  {
    "name": "Sales Tax Test",
    "department": "Primary"
  },
  {
    "name": "Stoerzinger Supply Co",
    "department": "Warehouse"
  },
  {
    "name": "Test Jeff Customer",
    "department": "Primary"
  },
  {
    "name": "Uniform Snow Inc",
    "department": "Warehouse"
  },
  {
    "name": "Warcraft Players Association",
    "department": "Primary"
  },
  {
    "name": "Whiting and Associates",
    "department": "Primary"
  },
  {
    "name": "Google",
    "department": "Primary"
  },
  {
    "name": "atlas staffing",
    "department": "Primary"
  },
  {
    "name": "Best Buy",
    "department": "Primary"
  },
  {
    "name": "Cleaning inc",
    "department": "Primary"
  },
  {
    "name": "David's Bridal",
    "department": "Primary"
  },
  {
    "name": "Global Technologies, Inc",
    "department": "Primary"
  },
  {
    "name": "Global Technologies, Inc.",
    "department": "Packline"
  },

  {
    "name": "Largo Boats",
    "department": "Primary"
  },


  {
    "name": "Stanley Tools",
    "department": "Primary"
  },
  {
    "name": "Stanley Tools",
    "department": "Primary"
  },
  {
    "name": "Stanley Tools",
    "department": "Primary"
  },
  {
    "name": "Talbots",
    "department": "Primary"
  },
  {
    "name": "Vandy Enterprises",
    "department": "Primary"
  },
  {
    "name": "Walmart",
    "department": "Primary"
  },
  {
    "name": "XYZ Corp",
    "department": "Primary"
  },
  {
    "name": "Kyle's Zip Testers",
    "department": "Primary"
  }
];
var randomTag = tags[Math.floor(Math.random() * tags.length)];

var loadContactables = function (hierId) {
  // Employees
  _.forEach(employees, function (data) {

    var status = LookUps.findOne({ lookUpCode: Enums.lookUpTypes.employee.status.lookUpCode, isDefault: true, hierId: hierId });
    if (status == null) LookUps.findOne({ lookUpCode: Enums.lookUpTypes.employee.status.lookUpCode, hierId: hierId });
    if (status == null) console.log("unable to find default status code for employee");

    var jobTitles = LookUps.find({lookUpCode: Enums.lookUpTypes.job.titles.lookUpCode, hierId: hierId}).fetch();
    var randomJobTitle = jobTitles[Math.floor(Math.random() * jobTitles.length)];

    var newEmployee = {
      Employee: {
        description: "top candidate",
        status: status ? status._id : null
      },
      tags: randomTag,
      statusNote: 'looks to be making a decision soon',
      objNameArray: ["person", "Employee", "contactable"],
      person: {
        firstName: data.firstName,
        middleName: "",
        lastName: data.lastName,
        jobTitle: randomJobTitle.displayName,
        salutation: ""
      },
      hierId: hierId,
      testData: true
    };

    ContactableManager.create(newEmployee);
  });


  // Customers
  _.forEach(customers, function (data) {

    var status = LookUps.findOne({ lookUpCode: Enums.lookUpTypes.customer.status.lookUpCode, isDefault: true, hierId: hierId });
    if (status == null) LookUps.findOne({lookUpCode: Enums.lookUpTypes.customer.status.lookUpCode, hierId: hierId});
    if (status == null) console.log("unable to find default status code for customer");

    var newCustomer = {
      Customer: {
        department: data.department,
        status: status ? status._id : null
      },
      tags: randomTag,
      statusNote: 'looks to be making a decision soon',
      objNameArray: ["organization", "Customer", "contactable"],
      organization: {
        organizationName: data.name
      },
      hierId: hierId,
      testData: true
    };

    ContactableManager.create(newCustomer);
  });

  _.forEach(contacts, function (data) {

    var status = LookUps.findOne({ lookUpCode: Enums.lookUpTypes.contact.status.lookUpCode, isDefault: true, hierId: hierId });
    if (status == null) LookUps.findOne({ lookUpCode: Enums.lookUpTypes.contact.status.lookUpCode, hierId: hierId });
    if (status == null) console.log("unable to find default status code for contact");

    var jobTitles = LookUps.find({lookUpCode: Enums.lookUpTypes.job.titles.lookUpCode, hierId: hierId}).fetch();
    var randomJobTitle = jobTitles[Math.floor(Math.random() * jobTitles.length)];
    var customers = Contactables.find({objNameArray: 'Customer',hierId:hierId}).fetch();
    var randomCustomer = customers[Math.floor(Math.random() * customers.length)];
    var newContact = {
      Contact: {
        description: "buying influence",
        status: status ? status._id : null,
        customer: randomCustomer._id,
      },
      tags: randomTag,
      statusNote: 'looks to be making a decision soon',
      objNameArray: ["person", "Contact", "contactable"],
      person: {
        firstName: data.firstName,
        middleName: "",
        lastName: data.lastName,
        jobTitle: randomJobTitle.displayName,
        salutation: ""
      },
      hierId: hierId,
      testData: true
    };

    ContactableManager.create(newContact);
  });
};

var loadJobs = function (hierId) {
    var customers = Contactables.find({objNameArray: 'Customer',hierId:hierId}).fetch();
    var jobTypes = dType.ObjTypes.find({parent: 'job'}).fetch()
    var industries = LookUps.find({lookUpCode: Enums.lookUpTypes.job.industry.lookUpCode,hierId:hierId}).fetch();
    var categories = LookUps.find({lookUpCode: Enums.lookUpTypes.job.category.lookUpCode,hierId:hierId}).fetch();
    var durations = LookUps.find({lookUpCode: Enums.lookUpTypes.job.duration.lookUpCode,hierId:hierId}).fetch();
    var jobTitles = LookUps.find({lookUpCode: Enums.lookUpTypes.job.titles.lookUpCode,hierId:hierId}).fetch();
    var statuses = LookUps.find({lookUpCode: Enums.lookUpTypes.job.status.lookUpCode,hierId:hierId}).fetch();
    var publicJobTitles = [
        ["QCI"  ],
        ["Production/sewing"  ],
        ["Shipping And Receiving Clerk"  ],
        ["Access Operator"  ],

        ["Typist/statistical"  ],
        ["Auditor"  ],
        ["Warehouse Person"  ],
        ["Utility Worker"  ],
        ["Administrative Support"  ],
        ["Special Project(s)"  ],
        ["Accounts Payable"  ],
        ["Accounts Receivable Clerk"  ],
        ["12 hour Nurse"  ],
        ["Accounting Clerk 1"  ],
        ["Budget Analyst"  ],
        ["Accountant"  ],

        ["Yard People"  ],
        ["Wagemaster"  ],
        ["Welder"  ],
        ["Assembler Heavy"  ],
        ["Accountant"  ],
        ["Administrative Support"  ],

        ["Yard People"  ],
        ["Access Operator"  ],
        ["Admin. Assist."  ],
        ["Accountant"  ],
        ["Forklift"  ],
        ["Packaging"  ],
        ["Server Deposit"  ],
        ["Administrative Support"  ],
        ["Forklift"  ],
        ["Assembler Heavy"  ],
        ["Administrative Support"  ],
        ["C#"  ],
        ["Access Operator"  ],
        ["Yard People"  ],
        ["Background Checks"  ],
        ["General Administrator I"  ],
        ["Fabricating Machine"  ],
        ["Hand Nailer"  ]

    ];


  for (var i = 0; i < 25; ++i) {

        var randomJobType = 'Temporary'; //jobTypes[Math.floor(Math.random() * jobTypes.length)];
        var randomCustomer = customers[Math.floor(Math.random() * customers.length)];
        var randomJobTitle = jobTitles [Math.floor(Math.random() * jobTitles.length)];
        var randomPublicJobTitle = publicJobTitles [Math.floor(Math.random() * publicJobTitles.length)];

        var newJob = {
            tags: randomTag,
            customer: randomCustomer._id,
            Temporary: {},
            objNameArray: ['job', 'Temporary'],
            hierId: hierId,
            industry: industries[Math.floor(Math.random() * industries.length)]._id,
            category: categories[Math.floor(Math.random() * categories.length)]._id,
            duration: durations[Math.floor(Math.random() * durations.length)]._id,
            status: statuses[Math.floor(Math.random() * statuses.length)]._id,
            publicJobTitle: randomPublicJobTitle[0],
            jobTitle: randomJobTitle._id,
            statusNote: 'looks to be making a decision soon',
            description: "a job for all times",
            testData: true
        }
        // TODO: check objType's fields

        Meteor.call('addJob', newJob, function (err, result) {
            if (!err)
                console.log("Job created for demo")
            else
                console.log(err);
        })
    }
    ;
};


var loadPlacements = function (hierId) {
  var today = new Date();
  var tomorrow = new Date();
  tomorrow.setDate(today.getDate() + 1);
  var jobs = Jobs.find({ hierId: hierId}).fetch();

  var employees = Contactables.find({objNameArray: 'Employee',hierId:hierId}).fetch();
  var candidateStatuses = LookUps.find({lookUpCode: Enums.lookUpTypes.candidate.status.lookUpCode,hierId:hierId}).fetch();
  var rateType=           LookUps.findOne({lookUpCode: Enums.lookUpTypes.placement.rate.lookUpCode,hierId:hierId});
  for (var i = 0; i < 10; ++i) {
    var randomJob = jobs[Math.floor(Math.random() * jobs.length)];
    var randomEmployee = employees[Math.floor(Math.random() * employees.length)];
    var newPlacement = {
      tags: [],
      job: randomJob._id,
      objNameArray: 	 ["placement"],
      employee: randomEmployee._id,
      candidateStatus: candidateStatuses[Math.floor(Math.random() * candidateStatuses.length)]._id,
      hierId: hierId,
      startDate: today,
      endDate: tomorrow,
      statusNote: 'excited about the job',
      "placementRates" :
        [{
          "type" : rateType._id,
          "pay" : "25.00",
          "bill" : "15.00"
        }],
      testData: true
    }
    // TODO: check objType's fields

    Meteor.call('addPlacement', newPlacement, function (err, result) {
      if (!err)
        console.log("Placement created for demo")
      else
        console.log(err);
    })
  };
};



var loadTasks = function (hierId, usermane, userId) {
    var notes = [
        "Call " + employees[Math.floor(Math.random() * employees.length)].firstName + " asap",
        "Contact " + employees[Math.floor(Math.random() * employees.length)].lastName
    ];

    // Add users to hier
    var userIds = [];
    //for (var j = 0; j < 5; ++j) {
    //    var newUser = {
    //        username: usermane + j,
    //        email: usermane + j + '@' + usermane + j + '.com',
    //        password: usermane + j
    //    }
    //    var id = Meteor.call('addHierUser', newUser, hierId);
    //    userIds.push(id);
    //}
    if (userId)
        userIds.push(userId);

    var today = new Date();
    var tomorrow = new Date();
    tomorrow.setDate(today.getDate() + 1);

    for (var i = 0; i < 50; ++i) {
        var newTask = {
            begin: today,
            end: tomorrow,
            assign: [userIds[Math.floor(Math.random() * userIds.length)]],
            msg: notes[Math.floor(Math.random() * notes.length)],
            completed: null,
            hierId: hierId,
            userId: userId,
            testData: true,
            links: []
        }

        Tasks.insert(newTask, function (err, result) {
            if (!err)
                console.log("Task created for demo");
            else
                console.log(err);
        })
    }
};

demoSeed = {
  loadContactables: loadContactables,
  loadJobs: loadJobs,
  loadTasks: loadTasks
};

// For testing
Meteor.methods({
  loadDemoData: function () {
    var user = Meteor.user();
    if (!user)
      return;

    loadContactables(user.hierId);
    loadJobs(user.hierId);
    loadPlacements(user.hierId);
    loadTasks(user.hierId, user.username, user._id);
  },
  removeDemoData: function () {
    var user = Meteor.user();
    if (!user)
      return;

    _.each([Contactables, Jobs, Tasks], function (collection) {
      collection.direct.remove({ hierId: user.hierId, testData: true });
    });
  }
});